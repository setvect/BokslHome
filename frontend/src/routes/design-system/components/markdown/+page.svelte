<script lang="ts">
  import MarkdownEditor from '$lib/components/ui/MarkdownEditor.svelte';
  
  // ë°ì´í„° ê°€ì ¸ì˜¤ê¸° í•¸ë“¤ëŸ¬
  function handleFetchData() {
    console.log('===== ë§ˆí¬ë‹¤ìš´ ì—ë””í„° ë‚´ìš© =====');
    console.log(editorValue);
    console.log('===============================');
    console.log('ê¸¸ì´:', editorValue.length, 'ë¬¸ì');
  }

  let editorValue = `# MarkdownEditor ì»´í¬ë„ŒíŠ¸

ì‹¤ì‹œê°„ ë§ˆí¬ë‹¤ìš´ í¸ì§‘ê³¼ ë¯¸ë¦¬ë³´ê¸°ë¥¼ ì œê³µí•˜ëŠ” ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤.

## ì£¼ìš” ê¸°ëŠ¥

- âœ… **ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°**: ì™¼ìª½ ì—ë””í„°, ì˜¤ë¥¸ìª½ ë¯¸ë¦¬ë³´ê¸°
- âœ… **í…Œë§ˆ ì—°ë™**: ë¼ì´íŠ¸/ë‹¤í¬ ëª¨ë“œ ìë™ ì „í™˜  
- âœ… **í´ë¦½ë³´ë“œ ì´ë¯¸ì§€**: ì´ë¯¸ì§€ ë¶™ì—¬ë„£ê¸° ì§€ì›
- âœ… **ì½”ë“œ í•˜ì´ë¼ì´íŒ…**: ë‹¤ì–‘í•œ ì–¸ì–´ë³„ êµ¬ë¬¸ ê°•ì¡°
- âœ… **Mermaid ë‹¤ì´ì–´ê·¸ë¨**: í”Œë¡œìš°ì°¨íŠ¸, ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ ë“±
- âœ… **ì „ì²´í™”ë©´ ëª¨ë“œ**: ESC í‚¤ë¡œ í•´ì œ ê°€ëŠ¥

## ì½”ë“œ í•˜ì´ë¼ì´íŒ… ì˜ˆì œ

### JavaScript/TypeScript
\`\`\`javascript
function fibonacci(n) {
  if (n <= 1) return n;
  return fibonacci(n - 1) + fibonacci(n - 2);
}

// ë°°ì—´ ë©”ì„œë“œ ì²´ì´ë‹
const numbers = [1, 2, 3, 4, 5];
const result = numbers
  .filter(x => x % 2 === 0)
  .map(x => x * 2)
  .reduce((sum, x) => sum + x, 0);

console.log('Result:', result);
\`\`\`

\`\`\`typescript
interface User {
  id: number;
  name: string;
  email?: string;
}

class UserService {
  private users: User[] = [];
  
  addUser(user: User): void {
    this.users.push(user);
  }
  
  findUser(id: number): User | undefined {
    return this.users.find(user => user.id === id);
  }
}

const userService = new UserService();
\`\`\`

### Python
\`\`\`python
class Calculator:
    def __init__(self):
        self.history = []
    
    def add(self, a: float, b: float) -> float:
        result = a + b
        self.history.append(f"{a} + {b} = {result}")
        return result
    
    def get_history(self):
        return self.history

# ë¦¬ìŠ¤íŠ¸ ì»´í”„ë¦¬í—¨ì…˜
numbers = [1, 2, 3, 4, 5]
squared = [x**2 for x in numbers if x % 2 == 0]

# ë°ì½”ë ˆì´í„° ì˜ˆì œ
def timer(func):
    def wrapper(*args, **kwargs):
        start = time.time()
        result = func(*args, **kwargs)
        print(f"ì‹¤í–‰ ì‹œê°„: {time.time() - start:.2f}ì´ˆ")
        return result
    return wrapper

@timer
def slow_function():
    time.sleep(1)
    return "ì™„ë£Œ"
\`\`\`

### Java
\`\`\`java
public class BinarySearch {
    public static int search(int[] arr, int target) {
        int left = 0;
        int right = arr.length - 1;
        
        while (left <= right) {
            int mid = left + (right - left) / 2;
            
            if (arr[mid] == target) {
                return mid;
            } else if (arr[mid] < target) {
                left = mid + 1;
            } else {
                right = mid - 1;
            }
        }
        
        return -1; // Not found
    }
    
    public static void main(String[] args) {
        int[] numbers = {1, 3, 5, 7, 9, 11, 13, 15};
        int result = search(numbers, 7);
        System.out.println("ì¸ë±ìŠ¤: " + result);
    }
}
\`\`\`

### Go
\`\`\`go
package main

import (
    "fmt"
    "sync"
    "time"
)

type Counter struct {
    mu    sync.Mutex
    value int
}

func (c *Counter) Increment() {
    c.mu.Lock()
    defer c.mu.Unlock()
    c.value++
}

func (c *Counter) Value() int {
    c.mu.Lock()
    defer c.mu.Unlock()
    return c.value
}

func main() {
    counter := &Counter{}
    var wg sync.WaitGroup
    
    // 10ê°œ ê³ ë£¨í‹´ìœ¼ë¡œ ë™ì‹œ ì¦ê°€
    for i := 0; i < 10; i++ {
        wg.Add(1)
        go func() {
            defer wg.Done()
            for j := 0; j < 100; j++ {
                counter.Increment()
                time.Sleep(time.Millisecond)
            }
        }()
    }
    
    wg.Wait()
    fmt.Printf("ìµœì¢… ê°’: %d\\n", counter.Value())
}
\`\`\`

### Rust
\`\`\`rust
use std::collections::HashMap;

#[derive(Debug, Clone)]
struct Book {
    title: String,
    author: String,
    pages: u32,
}

impl Book {
    fn new(title: &str, author: &str, pages: u32) -> Self {
        Book {
            title: title.to_string(),
            author: author.to_string(),
            pages,
        }
    }
}

fn main() {
    let mut library: HashMap<String, Book> = HashMap::new();
    
    let book1 = Book::new("The Rust Programming Language", "Steve Klabnik", 552);
    let book2 = Book::new("Programming Rust", "Jim Blandy", 624);
    
    library.insert(book1.title.clone(), book1);
    library.insert(book2.title.clone(), book2);
    
    // íŒ¨í„´ ë§¤ì¹­
    match library.get("The Rust Programming Language") {
        Some(book) => println!("ë°œê²¬: {:?}", book),
        None => println!("ì±…ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"),
    }
}
\`\`\`

### SQL
\`\`\`sql
-- ì‚¬ìš©ìì™€ ì£¼ë¬¸ ì •ë³´ë¥¼ ì¡°ì¸í•˜ì—¬ ì¡°íšŒ
SELECT 
    u.user_id,
    u.username,
    u.email,
    COUNT(o.order_id) as total_orders,
    SUM(o.amount) as total_amount,
    AVG(o.amount) as avg_amount
FROM users u
LEFT JOIN orders o ON u.user_id = o.user_id
WHERE u.created_at >= '2024-01-01'
GROUP BY u.user_id, u.username, u.email
HAVING COUNT(o.order_id) > 0
ORDER BY total_amount DESC
LIMIT 10;

-- ì¸ë±ìŠ¤ ìƒì„±
CREATE INDEX idx_orders_user_date 
ON orders (user_id, created_at);

-- íŠ¸ëœì­ì…˜ ì˜ˆì œ
BEGIN TRANSACTION;
    UPDATE accounts SET balance = balance - 100 WHERE account_id = 1;
    UPDATE accounts SET balance = balance + 100 WHERE account_id = 2;
    INSERT INTO transactions (from_account, to_account, amount) 
    VALUES (1, 2, 100);
COMMIT;
\`\`\`

### Bash/Shell
\`\`\`bash
#!/bin/bash

# í•¨ìˆ˜ ì •ì˜
deploy_app() {
    local env=$1
    local version=$2
    
    echo "ë°°í¬ ì‹œì‘: $env í™˜ê²½, ë²„ì „ $version"
    
    # ë°±ì—… ìƒì„±
    if [ -d "/opt/app" ]; then
        sudo cp -r /opt/app "/opt/app.backup.$(date +%Y%m%d_%H%M%S)"
        echo "ë°±ì—… ì™„ë£Œ"
    fi
    
    # ìƒˆ ë²„ì „ ë‹¤ìš´ë¡œë“œ
    wget "https://releases.myapp.com/v$version/app.tar.gz" -O "/tmp/app.tar.gz"
    
    # ì••ì¶• í•´ì œ ë° ë°°í¬
    cd /tmp
    tar -xzf app.tar.gz
    sudo mv app /opt/
    sudo chown -R app:app /opt/app
    sudo chmod +x /opt/app/bin/*
    
    # ì„œë¹„ìŠ¤ ì¬ì‹œì‘
    sudo systemctl restart myapp
    
    # í—¬ìŠ¤ì²´í¬
    for i in {1..30}; do
        if curl -s http://localhost:8080/health > /dev/null; then
            echo "ë°°í¬ ì„±ê³µ!"
            return 0
        fi
        sleep 2
    done
    
    echo "ë°°í¬ ì‹¤íŒ¨ - í—¬ìŠ¤ì²´í¬ ì‹¤íŒ¨"
    return 1
}

# ì‚¬ìš©ë²• ê²€ì‚¬
if [ $# -lt 2 ]; then
    echo "ì‚¬ìš©ë²•: $0 <í™˜ê²½> <ë²„ì „>"
    echo "ì˜ˆ: $0 production 1.2.3"
    exit 1
fi

deploy_app "$1" "$2"
\`\`\`

### JSON/YAML
\`\`\`json
{
  "name": "bokslhome",
  "version": "1.0.0",
  "description": "BokslHome í”„ë¡ íŠ¸ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜",
  "scripts": {
    "dev": "vite dev",
    "build": "vite build",
    "preview": "vite preview",
    "check": "svelte-kit sync && svelte-check --tsconfig ./tsconfig.json",
    "check:watch": "svelte-kit sync && svelte-check --tsconfig ./tsconfig.json --watch",
    "test": "vitest",
    "lint": "prettier --check . && eslint .",
    "format": "prettier --write ."
  },
  "dependencies": {
    "@codemirror/lang-markdown": "^6.2.4",
    "svelte": "^5.0.0",
    "prismjs": "^1.29.0"
  }
}
\`\`\`

\`\`\`yaml
# Docker Compose ì„¤ì •
version: '3.8'

services:
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - API_URL=http://backend:8080
    depends_on:
      - backend
    restart: unless-stopped

  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=prod
      - DB_URL=jdbc:h2:file:./data/bokslhome
    volumes:
      - ./data:/app/data
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/actuator/health"]
      interval: 30s
      timeout: 10s
      retries: 3

networks:
  default:
    driver: bridge
\`\`\`

## Mermaid ë‹¤ì´ì–´ê·¸ë¨ ì˜ˆì œ

\`\`\`mermaid
flowchart TD
    A[ì‹œì‘] --> B{ì¡°ê±´ í™•ì¸}
    B -->|Yes| C[ì²˜ë¦¬ A]
    B -->|No| D[ì²˜ë¦¬ B]
    C --> E[ì¢…ë£Œ]
    D --> E
\`\`\`

**í…ŒìŠ¤íŠ¸í•´ë³´ì„¸ìš”:**
- ë‹¤ì–‘í•œ ì–¸ì–´ ì½”ë“œ ë¸”ë¡ì˜ êµ¬ë¬¸ ê°•ì¡° í™•ì¸
- ì´ë¯¸ì§€ë¥¼ í´ë¦½ë³´ë“œì—ì„œ ë¶™ì—¬ë„£ê¸° (Ctrl+V)
- ì „ì²´í™”ë©´ ë²„íŠ¼ í´ë¦­
- ë¯¸ë¦¬ë³´ê¸° í† ê¸€ ë²„íŠ¼ ì‚¬ìš©`;
</script>

<div class="container">
  <h1>MarkdownEditor</h1>
  
  <!-- Props í…Œì´ë¸” -->
  <section class="props-section">
    <h2>Props</h2>
    <div class="props-table">
      <div class="props-header">
        <div>Prop</div>
        <div>Type</div>
        <div>Default</div>
        <div>Description</div>
      </div>
      <div class="props-row">
        <div><code>value</code></div>
        <div><code>string</code></div>
        <div><code>'# Hello Markdown!...'</code></div>
        <div>ì—ë””í„°ì˜ ì´ˆê¸° ë‚´ìš© (ì–‘ë°©í–¥ ë°”ì¸ë”©)</div>
      </div>
      <div class="props-row">
        <div><code>readOnly</code></div>
        <div><code>boolean</code></div>
        <div><code>false</code></div>
        <div>ì½ê¸° ì „ìš© ëª¨ë“œ</div>
      </div>
      <div class="props-row">
        <div><code>height</code></div>
        <div><code>string</code></div>
        <div><code>'400px'</code></div>
        <div>ì—ë””í„° ë†’ì´</div>
      </div>
      <div class="props-row">
        <div><code>showPreview</code></div>
        <div><code>boolean</code></div>
        <div><code>true</code></div>
        <div>ë¯¸ë¦¬ë³´ê¸° ì´ˆê¸° í‘œì‹œ ì—¬ë¶€</div>
      </div>
      <div class="props-row">
        <div><code>onChange</code></div>
        <div><code>(value: string) => void</code></div>
        <div><code>undefined</code></div>
        <div>ë‚´ìš© ë³€ê²½ ì‹œ í˜¸ì¶œë˜ëŠ” ì½œë°±</div>
      </div>
      <div class="props-row">
        <div><code>onImageUpload</code></div>
        <div><code>(file: File) => Promise&lt;string&gt;</code></div>
        <div><code>undefined</code></div>
        <div>ì»¤ìŠ¤í…€ ì´ë¯¸ì§€ ì—…ë¡œë“œ í•¨ìˆ˜</div>
      </div>
    </div>
  </section>

  <!-- ì»¨íŠ¸ë¡¤ ë²„íŠ¼ -->
  <section class="controls-section">
    <button 
      class="fetch-data-btn"
      onclick={handleFetchData}
    >
      ğŸ“„ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    </button>
  </section>

  <!-- ì—ë””í„° -->
  <section class="editor-section">
    <MarkdownEditor 
      bind:value={editorValue}
      height="600px"
      showPreview={false}  
    />
  </section>
</div>

<style>
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
  }

  h1 {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 32px;
    color: var(--foreground);
  }

  .props-section {
    margin-bottom: 32px;
  }

  .props-section h2 {
    font-size: 1.8rem;
    font-weight: 600;
    margin-bottom: 16px;
    color: var(--foreground);
  }

  .controls-section {
    margin-bottom: 24px;
    display: flex;
    gap: 12px;
  }

  .fetch-data-btn {
    padding: 8px 16px;
    background: var(--primary);
    color: var(--primary-foreground);
    border: none;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: background-color 0.2s;
  }

  .fetch-data-btn:hover {
    background: var(--primary)/90;
    opacity: 0.9;
  }

  .props-table {
    border: 1px solid var(--border);
    border-radius: 8px;
    overflow: hidden;
  }

  .props-header {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr 2fr;
    background: var(--muted);
    font-weight: 600;
    padding: 12px;
    border-bottom: 1px solid var(--border);
  }

  .props-row {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr 2fr;
    padding: 12px;
    border-bottom: 1px solid var(--border);
  }

  .props-row:last-child {
    border-bottom: none;
  }

  .props-row code {
    background: var(--muted);
    padding: 2px 6px;
    border-radius: 4px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.9rem;
  }

  .editor-section {
    margin-top: 32px;
  }

  /* ë°˜ì‘í˜• */
  @media (max-width: 768px) {
    .props-header,
    .props-row {
      grid-template-columns: 1fr;
      gap: 8px;
    }

    .props-header div,
    .props-row div {
      padding: 4px 0;
    }
  }
</style>